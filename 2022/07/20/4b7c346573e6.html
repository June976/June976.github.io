<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/favicon/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/favicon/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/images/favicon/apple-touch-icon.png?v=2.6.2" sizes="180x180"><link rel="mask-icon" href="/images/favicon/safari_pinned_tab.svg?v=2.6.2" color="#54bcff"><meta name="msapplication-TileImage" content="/images/favicon/mstile-150x150.png"><meta name="msapplication-TileColor" content="#000000"><meta name="google-site-verification" content="zjHtMN5bFl4jkMXnYa-Qxnv5aCHi4hiWmq19dRvW9dE"><meta name="msvalidate.01" content="3FCE749E09FA739F3F8966641CE2F104"><meta name="baidu-site-verification" content="code-qK1Gt1cc5G"><meta name="description" content="IBRION 参数是 VASP 计算中一个使用频率较高的参数，其功能涉及到离子弛豫、分子动力学和声子计算，同时 VASP Wiki上关于参数的使用给出了非常详细的说明，这里打算把官网的说明简单翻译一下，同时在适当地方可能加入一点注释，主要是为了加深自己的理解，这是原文地址：https:&#x2F;&#x2F;www.vasp.at&#x2F;wiki&#x2F;index.php&#x2F;IBRION。">
<meta property="og:type" content="article">
<meta property="og:title" content="VASP官网关于IBRION参数的说明">
<meta property="og:url" content="https://june976.github.io/2022/07/20/4b7c346573e6.html">
<meta property="og:site_name" content="Jun&#39;s Blog">
<meta property="og:description" content="IBRION 参数是 VASP 计算中一个使用频率较高的参数，其功能涉及到离子弛豫、分子动力学和声子计算，同时 VASP Wiki上关于参数的使用给出了非常详细的说明，这里打算把官网的说明简单翻译一下，同时在适当地方可能加入一点注释，主要是为了加深自己的理解，这是原文地址：https:&#x2F;&#x2F;www.vasp.at&#x2F;wiki&#x2F;index.php&#x2F;IBRION。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-07-20T13:39:09.000Z">
<meta property="article:modified_time" content="2024-05-30T05:19:53.997Z">
<meta property="article:author" content="Jun">
<meta property="article:tag" content="DFT">
<meta property="article:tag" content="VASP">
<meta property="article:tag" content="提示">
<meta name="twitter:card" content="summary"><title>VASP官网关于IBRION参数的说明 | Jun's Blog</title><link ref="canonical" href="https://june976.github.io/2022/07/20/4b7c346573e6.html"><link rel="alternate" href="/sitemap.xml" type="application/atom+xml"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?eb65d34678c3ed9f0d7fada1c3991648';
  hm.async = true;

  if (false) {
    hm.setAttribute('data-pjax', '');
  }
  var s = document.getElementsByTagName('script')[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":8},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: true,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.1"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">About</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-sync"></i></span><span class="header-nav-menu-item__text">Next</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/Next/"><span class="header-nav-submenu-item__icon"><i class="fas fa-file-alt"></i></span><span class="header-nav-submenu-item__text">Doc</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="https://next.jun997.xyz/"><span class="header-nav-submenu-item__icon"><i class="fas fa-external-link-alt"></i></span><span class="header-nav-submenu-item__text">To</span></a></div></div></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Jun's Blog</div><div class="header-banner-info__subtitle">Share knowledges, Tell stories and Show something interesting!</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">VASP官网关于IBRION参数的说明</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-07-20</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2024-05-30</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon" data-popover="Visitors" data-popover-pos="up"><i class="fas fa-eye"></i></span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><p>IBRION 参数是 VASP 计算中一个使用频率较高的参数，其功能涉及到离子弛豫、分子动力学和声子计算，同时 <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/The_VASP_Manual" >VASP Wiki</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>上关于参数的使用给出了非常详细的说明，这里打算把官网的说明简单翻译一下，同时在适当地方可能加入一点注释，主要是为了加深自己的理解，这是原文地址：<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/IBRION" >https://www.vasp.at/wiki/index.php/IBRION</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>。</p>
<span id="more"></span>

        <h1 id="ibrion"   >
          <a href="#ibrion" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion"></a> IBRION</h1>
      
<p>可选的设置值：IBRION = -1 | 0 | 1 | 2 | 3 | 5 | 6 | 7 | 8 | 44</p>
<p>默认值：</p>
<ul>
<li>对于 NSW = -1 或者 0, IBRION = -1</li>
<li>其它，IBRION = -1<br />
描述： IBRION 参数决定了离子如何更新和移动</li>
</ul>
<hr />
<p>对于 IBRION=0, 执行的是分子动力学模拟，所有其它算法的目标都是弛豫到局部最低能量。对于复杂的弛豫问题建议使用共轭梯度算法(IBRION=2)，这一方法拥有最可靠的备份路径。当初始的结构猜测非常糟糕时，阻尼分子动力学(IBRION=3)会很有用。对于接近局部最低能量的情况，RMM-DIIS(IBRION=1)通常是最好的选择。IBRION=5 和 IBRION=6 使用有限差分方法来计算二阶导数(厄米矩阵和声子频率)，而 IBRION=7 和 IBRION=8 使用密度泛函微扰理论来计算这些导数。</p>

        <h1 id="ibrion-1不更新离子坐标"   >
          <a href="#ibrion-1不更新离子坐标" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion-1不更新离子坐标"></a> IBRION=-1:不更新离子坐标</h1>
      
<p>离子不移动，但是 <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NSW" >NSW</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 指定的外循环仍然会执行。在每个外循环中，电子的自由度被反复优化(除了测试的目的，这实际上不会起什么作用)。如果不需要更新离子位置，请使用 NSW=0。</p>

        <h1 id="ibrion0分子动力学"   >
          <a href="#ibrion0分子动力学" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion0分子动力学"></a> IBRION=0:分子动力学</h1>
      
<p>标准的从头算分子动力学，使用 <strong>Verlet</strong> 算法(如果VASP与stepprecor.o文件链接，则使用四阶预测校正器)来积分求解牛顿运动方程，<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/POTIM" >POTIM</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 参数指定以飞秒为单位的时间步长，[SMASS] 参数可以提供一些额外的控制参数。</p>

        <h2 id="1关于-verlet-算法"   >
          <a href="#1关于-verlet-算法" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#1关于-verlet-算法"></a> 1.关于 Verlet 算法</h2>
      
<p><strong>Verlet</strong> 方法是一种用于积分求解牛顿运动方程(或者更高阶)的数值方法，它经常被用于分子动力学模拟中粒子运动轨迹的求解，对于牛顿运动方程，形式为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mi>d</mi><mi>v</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\frac{dv}{dt}=a(t),\frac{dx}{dt}=v(t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a(t)=a(x(t),v(t),t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>，我们知道，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>都是关于t的连续函数，如果我们要实现数值求解，就必须离散化，因此可以把时间t划分成等长的时间间隔，来逐步求解，这样通过将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">v_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">x_{n+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>作泰勒展开即可得到：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>v</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>v</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mi>n</mi></msub><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mi>O</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mspace linebreak="newline"></mspace><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><msub><mi>v</mi><mi>n</mi></msub><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>a</mi><mi>n</mi></msub><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mi>O</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><mi mathvariant="normal">Δ</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">v_{n+1}=v_n + a_n\Delta t+O[(\Delta t^2)] \\
x_{n+1}=x_n + v_n\Delta t + \frac{1}{2}a_n(\Delta t)^2 + O[(\Delta t)^3]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<p>对于 <strong>Verlet</strong> 算法，递推关系为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>2</mn><msub><mi>x</mi><mi>n</mi></msub><mo>−</mo><msub><mi>x</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>a</mi><mi>n</mi></msub><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mspace linebreak="newline"></mspace><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>a</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{n+1} = 2x_n - x_{n-1} + a_n\Delta t^2 \\
a_n = a(x_n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0141079999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>可以看到，上式中并不包含速度项，另一种包含速度的是 <strong>Velocity-Verlet</strong> 算法，这一方法方法中包含速度项，迭代公式为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><msub><mi>v</mi><mi>n</mi></msub><mi mathvariant="normal">Δ</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>a</mi><mi>n</mi></msub><mi mathvariant="normal">Δ</mi><msup><mi>t</mi><mn>2</mn></msup><mspace linebreak="newline"></mspace><msub><mi>v</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>v</mi><mi>n</mi></msub><mo>+</mo><mfrac><mrow><msub><mi>a</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mn>2</mn></mfrac><mi mathvariant="normal">Δ</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x_{n+1} = x_n + v_n\Delta t + \frac{1}{2}a_n\Delta t^2 \\
v_{n+1} = v_n + \frac{a_n + a_{n+1}}{2}\Delta t
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">Δ</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.9463300000000001em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.26033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">Δ</span><span class="mord mathnormal">t</span></span></span></span></span></p>
<p>以上迭代公式中加入了速度项，使用更为广泛。</p>
<p>参考资料：</p>
<ul>
<li><span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/Verlet_integration" >https://en.wikipedia.org/wiki/Verlet_integration</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   href="https://www.physics.udel.edu/~bnikolic/teaching/phys660/numerical_ode/node5.html" >https://www.physics.udel.edu/~bnikolic/teaching/phys660/numerical_ode/node5.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>

        <h2 id="2关于vasp分子动力学计算的一些提示"   >
          <a href="#2关于vasp分子动力学计算的一些提示" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#2关于vasp分子动力学计算的一些提示"></a> 2.关于VASP分子动力学计算的一些提示</h2>
      
<p>这部分内容同样来自vaspwiki的官网：<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Molecular_dynamics_calculations" >https://www.vasp.at/wiki/index.php/Molecular_dynamics_calculations</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>。<br />
为了运行基本的分子动力学计算，需要执行以下步骤：</p>
<ul>
<li>选择一个足够大的超胞</li>
<li>如果继续计算，则将 CONTCAR 复制到 POSCAR 或者在 POSCAR 文件中提供原子的初始速度，如果初始没有提供原子的速度，那么原子的初始速度将是随机的，这是完全可以的，但是用户必须知道由于初始速度是完全随机的，不同计算中原子的轨迹将很难进行对比</li>
<li>INCAR 文件中主要需要设置的参数：
<ul>
<li>IBRION=0:执行分子动力学计算</li>
<li>POTIM:分子动力学运行的时间步长</li>
<li>NSW:分子动力学运行的步数</li>
<li>TEBEG/TEEND:设置热浴的初始/结束温度</li>
<li>ISIF:决定系综的类型</li>
<li>MDALGO:决定了使用那种热浴，常规的分子动力学由一位数字决定，但是在有偏分子动力学中，对于vasp6和更高版本，同样是一位数字，但是在vasp5.X版本中用两位数字决定，第一位数字决定热浴类型，第二位决定分子动力学类型。</li>
</ul>
</li>
<li>可选的系综和热浴类型：</li>
</ul>
<center><dd><div class="table-container"><table cellpadding="5" cellspacing="0" border="1">
<tbody><tr>
<td></td>
<td colspan="4" style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Category:Thermostats"  title="Category:Thermostats">热浴</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>
</td></tr>
<tr>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Category:Ensembles"  title="Category:Ensembles">系综</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Andersen_thermostat"  title="Andersen thermostat">Andersen</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Nose-Hoover_thermostat"  title="Nose-Hoover thermostat">Nose-Hoover</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Langevin_thermostat"  title="Langevin thermostat">Langevin</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO#MDALGO.3D13:_Multiple_Anderson_thermostats"  title="MDALGO">Multiple Andersen</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>
</td></tr>
<tr>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NVE_ensemble"  title="NVE ensemble">NVE</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td colspan="4" style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=1,  <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ANDERSEN_PROB"  title="ANDERSEN PROB">ANDERSEN_PROB</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=0.0
</td></tr>
<tr>
<td rowspan="2" style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NVT_ensemble"  title="NVT ensemble">NVT</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=1</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=2</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=3</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=13
</td></tr>
<tr>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=2</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=2</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=2</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=2
</td></tr>
<tr>
<td rowspan="2" style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NpT_ensemble"  title="NpT ensemble">NpT</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td rowspan="2" style="text-align: center;">not available</td>
<td rowspan="2" style="text-align: center;">not available</td>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=3</td>
<td rowspan="2" style="text-align: center;">not available
</td></tr>
<tr>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=3
</td></tr>
<tr>
<td style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NpH_ensemble"  title="NpH ensemble">NpH</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></td>
<td colspan="4" style="text-align: center;"><span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/MDALGO"  title="MDALGO">MDALGO</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=3, <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/ISIF"  title="ISIF">ISIF</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=3, <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/LANGEVIN_GAMMA_L"  title="LANGEVIN GAMMA L">LANGEVIN_GAMMA_L</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>=0.0
</td></tr></tbody></table></div></dd></center>

        <h1 id="ibrion1离子弛豫rmm-diis"   >
          <a href="#ibrion1离子弛豫rmm-diis" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion1离子弛豫rmm-diis"></a> IBRION=1:离子弛豫(RMM-DIIS)</h1>
      
<p>对于 IBRION=1，准牛顿算法被用来将离子弛豫到基态，力和应力张量被用来确定寻找平衡位置的搜索方向(不考虑总能量)，这一算法在初始位置接近局部最小值时非常快和高效，但是如果初始猜测位置不好，则会失败(在这种情况下使用 IBRION=2)。由于该算法建立了Hessian矩阵的近似值，因此需要非常精确的力否则将无法收敛，一个有效的解决办法是把 NELMIN 参数的值设为4或8(对于简单体相材料4就足够，而对于电荷密度收敛非常缓慢的复杂表面，可能需要设置为8)。这样会强制在每个离子步之间最少有4到8个电子步，并保证力在每一(离子)步中都收敛。</p>
<p>实现的算法被称作 RMM-DIIS 。它通过考虑来自先前迭代的信息隐式计算逆 Hessian 矩阵的近似值，刚开始时 Hessian 矩阵是对角的并且对角元等于 POTIM 。如果需要，来自旧步骤的信息(可能导致线性依赖)会自动从迭代历史记录中删除。保存在迭代历史中的向量数量对应于 Hessian 矩阵的秩不得超过的自由度，显然自由度的它的自由度是3*(NIONS-1)，但是对称性和约束可以降低这一自由度。</p>
<p>有两种内置算法可以从迭代历史中删除信息：</p>
<ol>
<li>如果在INCAR中指定了 <span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NFREE" >NFREE</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 参数，在迭代历史中仅保留了 NFREE 个离子步的迭代历史(近似 Hessian 矩阵的秩不超过 NFREE)。</li>
<li>如果没有指定 NFREE 参数，是否从迭代历史中删除信息的标准是基于逆 Hessian 矩阵的特征值谱：如果逆 Hessian 矩阵的一个特征值大于8，则丢弃来自先前步骤的信息。</li>
</ol>
<p>对于复杂问题，NFREE 通常可以设置为一个很大的值(10-20)，但是低维系统需要小心地设置(或则最好是精确计算自由度的数量)。NFREE增加到超过20几乎不能提高收敛性，如果 NFREE 设得太大，RMM-DIIS算法可能会发散。</p>
<p>一个合理的 POTIM 参数非常重要，并且对于计算的加速效果显著。我们建议使用 IBRION=2 或者运行一些测试计算来找到一个合适的 POTIM 参数。</p>

        <h1 id="ibrion2离子弛豫共轭梯度算法"   >
          <a href="#ibrion2离子弛豫共轭梯度算法" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion2离子弛豫共轭梯度算法"></a> IBRION=2:离子弛豫(共轭梯度算法)</h1>
      
<p>共轭梯度算法用来将离子弛豫到它们的基态上，在第一步离子(以及晶胞形状)沿着最陡的方向变化(如计算出的力或应力矩阵的方向)。共轭梯度算法需要一个线性优化器，它分为几个步骤执行：</p>
<ol>
<li>首先让离子向着搜索方向行进一个试验步，该步的长度由 POTIM 参数控制，然后重新计算能量和力。</li>
<li>考虑到总能量和力的变化(3条信息)，通过三次(或者二次)插值计算总能量的近似最小值，然后执行一个到近似最低能量结构的修正步。</li>
<li>执行修正步后，再重新计算能量和受力，并检查此时离子受力中是否还包含很多沿着搜索方向的成分，如果是，使用 Brent 算法的变体来进一步改进线优化器中的校正步。</li>
</ol>
<p>总的来说：在第一个离子步中，根据从 POSCAR 中读入的初始结构计算力，第二步时试验步(或预测步)，第三步是修正步。如果在这一步中线性最小化已经足够精确，那么就会开始下一个试验步。</p>
<p>NSTEP:</p>
<ul>
<li>初始位置</li>
<li>试验步</li>
<li>修正步，即对应于预期最小值的位置</li>
<li>试验步</li>
<li>校正步</li>
<li>…</li>
</ul>

        <h1 id="ibrion3离子弛豫阻尼分子动力学"   >
          <a href="#ibrion3离子弛豫阻尼分子动力学" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion3离子弛豫阻尼分子动力学"></a> IBRION=3:离子弛豫(阻尼分子动力学)</h1>
      
<p>如果在 INCAR 文件中通过 SMASS 标签指定了阻尼因子，那么阻尼二阶运动方程将用于更新离子的各个自由度：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>¨</mo></mover><mo>=</mo><mo>−</mo><mn>2</mn><mi>α</mi><mover accent="true"><mi>F</mi><mo>⃗</mo></mover><mo>−</mo><mi>μ</mi><mover accent="true"><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">\ddot{\vec{x}} = -2\alpha \vec{F}-\mu \dot{\vec{x}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.95086em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.95086em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span><span style="top:-3.283em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">¨</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0496599999999998em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663299999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.15216em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1453em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.95086em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span><span style="top:-3.283em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.13889em;"><span class="mord">˙</span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中 SMASS 指定阻尼因子μ，POTIM 控制 α。使用简单的 velocity verlet 算法来积分这个方程，离散的形式为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mrow><mi>N</mi><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msub><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>μ</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mrow><mi>N</mi><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msub><mo>−</mo><mn>2</mn><mi>α</mi><msub><mover accent="true"><mi>F</mi><mo>⃗</mo></mover><mi>N</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>μ</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mi>N</mi></msub><mo>+</mo><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mrow><mi>N</mi><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\vec{v}_{N+1/2}=((1-\mu /2)\vec{v}_{N-1/2}-2\alpha \vec{F}_N)/(1+\mu /2) \\
\vec{x}_{N+1}=\vec{x}_N + \vec{v}_{N+1/2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0692em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathnormal">μ</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.21633em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9663299999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.15216em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">μ</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.922331em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.328331em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.864em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0692em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>可以立即想到，当μ=2时上式等价于一种简单的最速下降法(当然没有线性优化器)。因此，μ=2对应于最大阻尼，而μ=0对应于没有阻尼。最佳阻尼因子取决于 Hessian 矩阵(能量关于原子位置的二阶导数矩阵)。μ的一个合理的猜测通常是0.4。</p>
<p>请注意，我们实现的算法对用户特别友好，因为更改μ通常不需要重新调整时间步长 POTIM。要选择最佳的时间步长和阻尼因子，我们建议采用以下两步程序：首先应该固定μ(例如为1)并调整 POTIM。POTIM 应选择尽可能大，而不会使总能量发散。然后减小μ并保持 POTIM 固定，如果 POTIM 和 SMASS 选择正确，阻尼分子动力学模式通常比共轭梯度法<strong>好两倍</strong>。</p>
<p>如果 INCAR 文件中没有指定 SMASS 参数，那么会使用 velocity quench 算法。在这种情况下，离子的位置根据以下算法更新：<strong>F</strong> 是目前的受力，并且α等于 POTIM。这一方程表明，如果力的方向和速度的方向是反平行，速度将被将为0。否则速度将被调整为平行于当前的受力，并且其增量与力成正比。</p>
<p>注意：对于 IBRION=3,需要通过 POTIM 参数来指定一个合理时间步，太大的时间步将导致不收敛，太小的时间步将降低收敛的速度，一个稳定的时间步通常是共轭梯度算法中线性优化步骤中的最小时间步。</p>

        <h1 id="ibrion5和6二阶导数-hessian-矩阵和声子频率有限差分"   >
          <a href="#ibrion5和6二阶导数-hessian-矩阵和声子频率有限差分" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion5和6二阶导数-hessian-矩阵和声子频率有限差分"></a> IBRION=5和6：二阶导数， Hessian 矩阵和声子频率(有限差分)</h1>
      
<p>可以在这里找到如何从有限差分中计算声子：<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Phonons_from_finite_differences" >有限差分声子</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>。</p>
<p>IBRION=5 在 VASP4.5 版本及以上可用，IBRION=6 从 VASP5.1 版本开始。这两个参数都允许计算 Hessian 矩阵(能量对原子位置的二阶导数)和系统的振动频率。只有区域中心(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Γ</mi></mrow><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">Γ</span></span></span></span>点)的频率会自动计算并在之后打印：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Eigenvectors and eigenvalues of the dynamical matrix</span><br></pre></td></tr></table></div></figure>
<p>为了计算 Hessian 矩阵，需要使用有限差分，即每个离子在每个笛卡尔坐标的方向上位移，并根据力计算 Hessian 矩阵。这两种模式在考虑对称性的方式上有所不同。对于 IBRION=5, 所有的原子都在所有的三个笛卡尔坐标方向上位移，即使对于中等大小的高对称系统，也会导致非常大的计算量。对于 IBRION=6,仅考虑对称性上不等价的位移，并使用对称性来填充 Hessian 矩阵的剩余部分。</p>
<p>Selective dynamics目前仅支持 IBRION=5 的情况。在这一情况下，仅仅计算那些在 POSCAR 文件中 Selective dynamic 标签设置为 .TRUE. 部分对应的 Hessian 矩阵的分量。例如：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Cubic BN</span><br><span class="line">   3.57</span><br><span class="line"> 0.0 0.5 0.5</span><br><span class="line"> 0.5 0.0 0.5</span><br><span class="line"> 0.5 0.5 0.0</span><br><span class="line">   1 1</span><br><span class="line">selective</span><br><span class="line">Direct</span><br><span class="line"> 0.00 0.00 0.00  F F F</span><br><span class="line"> 0.25 0.25 0.25  T F F</span><br></pre></td></tr></table></div></figure>
<p>原子2仅在x方向上位移，仅计算 Hessian 矩阵的第二个原子的x分量。</p>
<p>三个参数影响 Hessian 矩阵的计算：<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/NFREE" >NFREE</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> 参数决定了对于每个离子每个方向的计算选取多少个位移量，而 POTIM 指定位移的步长。如果在输入文件中设定的值太大，位移步长默认被设置为0.015A(从VASP5.1开始)。专业知识表明，这是一个合理的折衷方案。</p>
<p>NFREE=2 使用中心差分，即每个离子被施加一个小的正位移和负位移，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo></mrow><annotation encoding="application/x-tex">\pm</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">±</span></span></span></span>POTIM，沿着每个笛卡尔方向。对于 NFREE=4，沿着每个笛卡尔坐标的方向施加四个位移量：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo></mrow><annotation encoding="application/x-tex">\pm</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">±</span></span></span></span>POTIM 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>±</mo><mn>2</mn><mo>×</mo></mrow><annotation encoding="application/x-tex">\pm2\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">±</span><span class="mord">2</span><span class="mord">×</span></span></span></span>POTIM。</p>
<p>对于 NFREE=1，只施加一个位移量(非常不建议使用NFREE=1)。</p>
<p>最后，IBRION=6 和 ISIF <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>≥</mo></mrow><annotation encoding="application/x-tex">\geq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mrel">≥</span></span></span></span> 3允许计算弹性常数。弹性张量是通过对晶格进行六次有限变形并从应变——应力关系导出弹性常数来确定的。弹性张量的计算既适用于固定的离子，也适用于弛豫的离子，离子固定时计算的弹性模量信息在这一行之后：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYMMETRIZED ELASTIC MODULI (kBar)</span><br></pre></td></tr></table></div></figure>
<p>离子的贡献通过转置离子 Hessian 矩阵乘以内部应变张量来计算，相应的贡献写在以下行之后：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ELASTIC MODULI CONTR FROM IONIC RELAXATION (kBar)</span><br></pre></td></tr></table></div></figure>
<p>最终的弹性模量包含离子固定时扭曲的贡献和离子弛豫的贡献，在最后可以总结为：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TOTAL ELASTIC MODULI (kBar)</span><br></pre></td></tr></table></div></figure>
<p>这种方法有一些注意事项，最值得注意的是平面波的截断能能需要足够大以使应力张量收敛，这通常只有在截断能增加到默认值的30%左右才能实现，但强烈建议系统地测试一下，逐步增加截断能(以15%的步长)，直到完全收敛。</p>
<p>通过额外指定 LEPSILON=.TRUE.(线性相应理论)或 LCALCEPS=.TRUE.(有限外场)参数可以计算波恩有效电荷、压电常数和离子对介电张量的贡献。</p>
<p>关于老版本(VASP.5.1之前)的注释：在一些老版本中，INCAR 文件中 NSW 必须设置为1，因为 NSW=0 会不管 INCAR 中 IBRION 的设置值而直接将其设置为-1。</p>
<p>此外，尽管 VASP.4.6 支持 IBRION=5-6，VASP.4.6 不会自动改变k点集合(通常，结构施加位移之后需要使用不同的k点网格)。因此在 VASP.4.6 程序中有限差分方法可能会产生不正确的结果。</p>

        <h2 id="1关于-hessian-矩阵"   >
          <a href="#1关于-hessian-矩阵" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#1关于-hessian-矩阵"></a> 1.关于 Hessian 矩阵</h2>
      
<p>在数学上，Hessian 矩阵是标量函数或标量场的二阶偏导数的方阵。在 DFT 中，Hessian 矩阵是能量对体系几何结构的二阶导数，在力的计算中应用非常重要，计算过程中使用的位移是笛卡尔位移，因此 Hessian 是基于笛卡尔坐标而不是分数坐标。</p>
<p>Hessian 矩阵的元素定义为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msup><mi>δ</mi><mn>2</mn></msup><mi>E</mi></mrow><mrow><mi>δ</mi><msub><mi>x</mi><mi>i</mi></msub><mi>δ</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">H_{ij} = \frac{\delta ^2E}{\delta x_i \delta x_j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.463216em;vertical-align:-0.972108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.972108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>对于原子数量为N的体系，i的取值有3N个，通过对称性可以进一步减少自由度，详细的计算方法可以参考下面列出的参考文章2。</p>
<p>参考文章：</p>
<ul>
<li><span class="exturl"><a class="exturl__link"   href="https://en.wikipedia.org/wiki/Hessian_matrix" >https://en.wikipedia.org/wiki/Hessian_matrix</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   href="http://openmopac.net/manual/Hessian_Matrix.html" >http://openmopac.net/manual/Hessian_Matrix.html</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ul>

        <h1 id="ibrion7和8二阶导数hessian-矩阵和声子频率微扰理论"   >
          <a href="#ibrion7和8二阶导数hessian-矩阵和声子频率微扰理论" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion7和8二阶导数hessian-矩阵和声子频率微扰理论"></a> IBRION=7和8：二阶导数，Hessian 矩阵和声子频率(微扰理论)</h1>
      
<p>从 VASP.5.1 版本开始 IBRION=7 和 IBRION=8 都支持，它会用密度泛函微扰理论计算 Hessian 矩阵，IBRION=7 不会使用对称性，而 IBRION=8 会使用对称性来降低位移的数量，输出结果与 IBRION=5 和6类似。具体来说，有关于离子位移(原子间力常数)的二阶导数以及应变和离子位移(内部应变张量)的混合二阶导数。尽管计算了离子弛豫对弹性张量的贡献，但未确定钳制离子(离子固定)对弹性张量的贡献。如果在 INCAR 文件中指定了 LEPSILON=.TRUE.，波恩有效电荷、压电常数以及离子对介电张量的贡献都会计算。</p>
<p>总的来说，VASP 实现的 DFPT 计算有一点初级，只支持与超胞对称性相同的位移，即使 q=0 的声子。换句话说，VASP 只能计算超胞在Γ点的声子频率，因此，与上面讨论的有限差分方法相比，这部分的代码几乎没有优势，特别是，线性相应仅限于 LDA 和 GGA 泛函，它不能确定弹性张量，因为还没有实现相对于应变张量的线性响应，线性响应方法的唯一优点是它们无需选择有限位移的大小，因此，首先使用线性响应计算声子频率然后切换到有限差分方法来确定最大位移，这样将会产生与线性响应精度相当的结果。</p>
<p>这里需要知道一些技术细节。VASP 通过求解 Sternheimer 方程以确定轨道的线性响应。因此，不需要空轨道。在内部，VASP 的线性响应程序依赖于两个地方的有限差分：</p>
<ol>
<li>第一个地方是计算交换关联泛函的二阶导数：由于大多数泛函并不支持二阶导数的代数求解，VASP 总是通过有限差分来确定每个原子位移后的交换相关势的二阶变化和 PAW 的中心项。</li>
<li>第二个地方，在 VASP 确定了轨道的一阶变化之后，它会用有限差分方法来计算所有的二阶导数。</li>
</ol>
<p>为此，VASP 在选定的方向上将位移施加到选定的原子上，将线性响应计算添加到轨道，最后确定正位移和负位移对力和应力张量作用的差异，可以证明，这分别准确地产生了二阶力常数和内部应变张量。此外，通过在“极化矢量”Eq上收缩轨道地线性响应来“解析地”确定波恩有效电荷。这些计算的结果应该与之前在计算相对于外部场的线性响应时确定的波恩有效电荷非常吻合(有两种不同的方法来计算混合导数)。OUTCAR 文件末尾的最终汇总输出写入了根据外部场的线性响应确定的波恩有效电荷。</p>

        <h1 id="ibrion44改进的二聚体方法"   >
          <a href="#ibrion44改进的二聚体方法" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#ibrion44改进的二聚体方法"></a> IBRION=44：改进的二聚体方法</h1>
      
<p>参考这里：<span class="exturl"><a class="exturl__link"   href="https://www.vasp.at/wiki/index.php/Improved_Dimer_Method" >https://www.vasp.at/wiki/index.php/Improved_Dimer_Method</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h1 id="一些常识"   >
          <a href="#一些常识" class="heading-link"><i class="fas fa-link"></i></a><a class="markdownIt-Anchor" href="#一些常识"></a> 一些常识</h1>
      
<p>对于 IBRION=1、2和3，ISIF 标签决定晶胞的形状和离子的位置是否改变，在分子动力学模拟中(IBRION=0)只有在动力学模组使用 Tomas Bucko 时晶胞形状才被允许改变。</p>
<p>所有的弛豫算法都需要在 INCAR 文件中指定 POTIM 的值。对于 IBRION&gt;0，在调用最小化程序之前，力在内部进行缩放，因此对于弛豫，POTIM 并没有物理意义并且只是一个缩放因子，对于很多系统，最佳的 POTIM 在0.5左右，由于准牛顿算法和阻尼算法对这个参数的选择较为敏感，因此如果你不确定最佳的 POTIM 参数应该设多大，使用 IBRION=2 。</p>
<p>在这种情况下，OUTCAR 文件和标准输出设备中将包含一行显示可靠的 POTIM 。对于 IBRION=2，在每个校正步骤之后，以下行将被写入标准输出设备中：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">trial: gam=  .00000 g(F)=   .152E+01 g(S)=  .000E+00 ort = .000E+00</span><br><span class="line">(trialstep = .82)</span><br></pre></td></tr></table></div></figure>
<p>其中变量 gam 是上一步的共轭参数，g(F) 和 g(S) 分别是力和应力张量的模长，变量 ort 是一个指示器，表明当前的搜索方向与上一个搜索方向正交(对于最佳步长，该值应该远小于 g(F)+g(S) )。变量 trialstep 是当前试验步的步长。该值是使得上一个离子步中实现线最小化的平均步长，通过将当前 POTIM 参数与试验步长相乘，可以确定最佳的 POTIM 。</p>
<p>在每个试验步结束之后，以下信息将被写入到标准输出设备：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">trial-energy change:   -1.153185  1.order   -1.133   -1.527  -.739</span><br><span class="line">step:   1.7275(harm=  2.0557)  dis=  .12277  </span><br><span class="line">                           next Energy= -1341.57 (dE= -.142E+01)</span><br></pre></td></tr></table></div></figure>
<p>变量 trial-energy change 是试验步中能量的改变量，1.order 之后的第一个值是根据力计算得出的预期能量变化：(F(start)+F(trial))/2×change of positions.第二和第三个值对应于F(start)×change of positions, and F(trial)×change of positions。</p>
<p>第二行中的第一个值是导致沿当前搜索方向的线最小化的步长。它是使用开始和试验步(力和能量变化)中的数据通过三阶插值公式计算得到的，harm 是使用二阶(或谐波)插值得到的最佳步长，在谐波插值中只使用了力的信息，当接近最小值时，两个值应该相似。dis 是离子在分数坐标中移动的最大距离。next Energy 指示下一个能量应该多大(线最小化优化时的能量)，dE是估算的能量改变值。</p>
<p>在每个试验步结束时，OUTCAR 文件包含以下行：</p>
<figure class="highlight bash"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">trial-energy change:   -1.148928  1.order   -1.126  -1.518  -.735</span><br><span class="line"> (g-gl).g =  .152E+01      g.g   =  .152E+01  gl.gl    =  .000E+00</span><br><span class="line">g(Force)  =  .152E+01   g(Stress)=  .000E+00 ortho     =  .000E+00</span><br><span class="line">gamma     =    .00000</span><br><span class="line">opt step  =   1.72745  (harmonic =   2.05575) max dist = .12277085</span><br><span class="line">next E    = -1341.577507   (d E  =   1.42496)</span><br></pre></td></tr></table></div></figure>
<p>trial-energy change 行前面已经提过. g(Force) 代表 g(F), g(Stress) 代表 g(S), ortho 代表 ort, gamma 代表 gam.第二行中 gamma 之后的值(step: …)之前也讨论过。</p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://june976.github.io">Jun</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://june976.github.io/2022/07/20/4b7c346573e6.html">https://june976.github.io/2022/07/20/4b7c346573e6.html</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://june976.github.io/tags/DFT/">DFT</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://june976.github.io/tags/VASP/">VASP</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://june976.github.io/tags/%E6%8F%90%E7%A4%BA/">提示</a></span></div><div class="post-share"><div class="social-share" data-sites="qzone, qq, weibo, wechat, douban, linkedin, facebook, twitter, google">Share to: </div></div><div class="post-reward reward"><div class="reward-button">￥打赏我￥</div><div class="reward-qrcode"><span class="reward-qrcode-alipay"><img class="reward-qrcode-alipay__img" src="/images/PayQRCode/alipay.jpg"><div class="reward-qrcode-alipay__text">Alipay</div></span><span class="reward-qrcode-wechat"><img class="reward-qrcode-wechat__img" src="/images/PayQRCode/wechat.png"><div class="reward-qrcode-wechat__text">Wechat</div></span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2022/09/22/c59c75865653.html"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">高斯过程回归(Gaussian Processes Regression, GPR)简介</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2022/07/14/276373048e9d.html"><span class="paginator-prev__text">vasp+phonopy计算声子谱</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion"><span class="toc-number">1.</span> <span class="toc-text">
           IBRION</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion-1%E4%B8%8D%E6%9B%B4%E6%96%B0%E7%A6%BB%E5%AD%90%E5%9D%90%E6%A0%87"><span class="toc-number">2.</span> <span class="toc-text">
           IBRION&#x3D;-1:不更新离子坐标</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion0%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6"><span class="toc-number">3.</span> <span class="toc-text">
           IBRION&#x3D;0:分子动力学</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E5%85%B3%E4%BA%8E-verlet-%E7%AE%97%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">
           1.关于 Verlet 算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E5%85%B3%E4%BA%8Evasp%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6%E8%AE%A1%E7%AE%97%E7%9A%84%E4%B8%80%E4%BA%9B%E6%8F%90%E7%A4%BA"><span class="toc-number">3.2.</span> <span class="toc-text">
           2.关于VASP分子动力学计算的一些提示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion1%E7%A6%BB%E5%AD%90%E5%BC%9B%E8%B1%ABrmm-diis"><span class="toc-number">4.</span> <span class="toc-text">
           IBRION&#x3D;1:离子弛豫(RMM-DIIS)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion2%E7%A6%BB%E5%AD%90%E5%BC%9B%E8%B1%AB%E5%85%B1%E8%BD%AD%E6%A2%AF%E5%BA%A6%E7%AE%97%E6%B3%95"><span class="toc-number">5.</span> <span class="toc-text">
           IBRION&#x3D;2:离子弛豫(共轭梯度算法)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion3%E7%A6%BB%E5%AD%90%E5%BC%9B%E8%B1%AB%E9%98%BB%E5%B0%BC%E5%88%86%E5%AD%90%E5%8A%A8%E5%8A%9B%E5%AD%A6"><span class="toc-number">6.</span> <span class="toc-text">
           IBRION&#x3D;3:离子弛豫(阻尼分子动力学)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion5%E5%92%8C6%E4%BA%8C%E9%98%B6%E5%AF%BC%E6%95%B0-hessian-%E7%9F%A9%E9%98%B5%E5%92%8C%E5%A3%B0%E5%AD%90%E9%A2%91%E7%8E%87%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86"><span class="toc-number">7.</span> <span class="toc-text">
           IBRION&#x3D;5和6：二阶导数， Hessian 矩阵和声子频率(有限差分)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E5%85%B3%E4%BA%8E-hessian-%E7%9F%A9%E9%98%B5"><span class="toc-number">7.1.</span> <span class="toc-text">
           1.关于 Hessian 矩阵</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion7%E5%92%8C8%E4%BA%8C%E9%98%B6%E5%AF%BC%E6%95%B0hessian-%E7%9F%A9%E9%98%B5%E5%92%8C%E5%A3%B0%E5%AD%90%E9%A2%91%E7%8E%87%E5%BE%AE%E6%89%B0%E7%90%86%E8%AE%BA"><span class="toc-number">8.</span> <span class="toc-text">
           IBRION&#x3D;7和8：二阶导数，Hessian 矩阵和声子频率(微扰理论)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ibrion44%E6%94%B9%E8%BF%9B%E7%9A%84%E4%BA%8C%E8%81%9A%E4%BD%93%E6%96%B9%E6%B3%95"><span class="toc-number">9.</span> <span class="toc-text">
           IBRION&#x3D;44：改进的二聚体方法</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%AF%86"><span class="toc-number">10.</span> <span class="toc-text">
           一些常识</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/profile.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">A Journey of A Thousand Miles Begins with A Single Step!</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/June976" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://www.google.com/" target="_blank" rel="noopener" data-popover="Google" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-google"></i></span></a><a class="sidebar-ov-social-item" href="https://weibo.com/" target="_blank" rel="noopener" data-popover="Weibo" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weibo"></i></span></a><a class="sidebar-ov-social-item" href="https://www.zhihu.com/" target="_blank" rel="noopener" data-popover="Zhihu" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">知</span></a><a class="sidebar-ov-social-item" href="https://blog.csdn.net/HelloWorldTM?type=blog" target="_blank" rel="noopener" data-popover="social.CSDN" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">C</span></a><a class="sidebar-ov-social-item" href="mailto:admin@jun997.xyz" target="_blank" rel="noopener" data-popover="social.QQmail" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">M</span></a></div><div class="sidebar-ov-feed"><span class="sidebar-ov-feed-email"><a class="sidebar-ov-feed-email__link" href="https://mailchi.mp/78fbe8b89a13/juns-blog-subscribe" target="_blank" rel="noopener"><span class="sidebar-ov-feed-email__icon"><i class="fas fa-envelope"></i></span><span>Email Subscribe</span></a></span><span class="sidebar-ov-feed-rss"><a class="sidebar-ov-feed-rss__link" href="/sitemap.xml" target="_blank" rel="noopener"><span class="sidebar-ov-feed-rss__icon"><i class="fas fa-rss"></i></span><span>RSS Subscribe</span></a></span></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">351</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">38</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2025</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Jun All Rights Reserved</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.1</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon" data-popover-pos="up" data-popover="Unique Visitor"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon" data-popover-pos="up" data-popover="Page View"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>